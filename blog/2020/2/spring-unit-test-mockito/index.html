<!doctype html><html lang=zh-tw><head><meta charset=utf-8><title>SpringBoot - å–®å…ƒæ¸¬è©¦å·¥å…· Mockito
</title><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="ä»‹ç´¹å¦‚ä½•ä½¿ç”¨ Mockito æ¡†æ¶å¹«åŠ©æˆ‘å€‘æ›´æ–¹ä¾¿çš„é€²è¡Œ SpringBoot å–®å…ƒæ¸¬è©¦"><meta name=author content="å¤å¤"><meta property="og:image" content="https://kucw.io/images/logo.png"><meta name=generator content="Hugo 0.145.0 with theme pure"><link rel=stylesheet href=https://kucw.io/plugins/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://kucw.io/plugins/themify-icons/themify-icons.css><link rel=stylesheet href=https://kucw.io/plugins/venobox/venobox.css><link rel=stylesheet href=https://kucw.io/plugins/medium-zoom/medium-zoom.css><link rel=stylesheet href=https://kucw.io/scss/style.min.d0dbde05028230889123aec57bd4277b184ffb8ec8b13e1dae16f3946be51984.css media=screen><link rel="shortcut icon" href=https://kucw.io/images/favicon.png type=image/x-icon><link rel=icon href=https://kucw.io/images/favicon.png type=image/x-icon><script async src="https://www.googletagmanager.com/gtag/js?id=G-FDFT2W6V4S"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-NKQ46H0SJW")</script><script src=https://kucw.io/js/google-firebase-login.min.69fad9ce5fc6ddb2a672d6f8497b357c0eb6b5ff30ceea1601cdd8f2b936213b.js type=module></script></head><body><div class=preloader></div><header class=navigation><div class="container-fluid border-bottom fixed-top nav-background-color"><div class=nav-container><nav class="navbar navbar-expand-lg navbar-white bg-transparent px-0"><a class="navbar-brand desktop-view" href=https://kucw.io/><img class="img-fluid logo-with-text-size mx-1" src=https://kucw.io/images/logo-with-text-transparent.png alt>
</a><a class="navbar-brand navbar-brand-mobile mobile-view" href=https://kucw.io/><img class="img-fluid logo-thumb-sm rounded-circle" src=https://kucw.io/images/logo.png alt>
</a><button class="navbar-toggler border-0" type=button data-toggle=collapse data-target=#navigation>
<i class="ti-menu h3"></i></button><div class="collapse navbar-collapse text-center" id=navigation><ul class="navbar-nav mr-auto ml-2"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>å¾Œç«¯æŠ€è¡“å°ˆæ¬„</a><div class=dropdown-menu><a class=dropdown-item href=https://kucw.io/blog/springboot/1>Spring Boot é›¶åŸºç¤å…¥é–€</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>ç·šä¸Šèª²ç¨‹</a><div class=dropdown-menu><a class=dropdown-item href=https://hahow.in/cr/kucw-github-hugo target=_blank rel=noopener>GitHub å…è²»æ¶ç«™è¡“ï¼è¼•é¬†æ‰“é€ å€‹äººå“ç‰Œ</a>
<a class=dropdown-item href=https://hahow.in/cr/springboot target=_blank rel=noopener>Java å·¥ç¨‹å¸«å¿…å‚™ï¼Spring Boot é›¶åŸºç¤å…¥é–€</a>
<a class=dropdown-item href=https://hahow.in/cr/springsecurity target=_blank rel=noopener>è³‡å®‰ä¸€æŠŠç½©ï¼Spring Security é›¶åŸºç¤å…¥é–€</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>è‡ªåª’é«” & æ•—å®¶å°ˆå€</a><div class=dropdown-menu><a class=dropdown-item href=https://kucw.io/blog/as-a-content-creator/1>è»Ÿé«”å·¥ç¨‹å¸«çš„è‡ªåª’é«”ä¹‹è·¯</a></div></li><li class=nav-item><a class=nav-link href=https://kucw.io/>æ‰€æœ‰æ–‡ç« </a></li><li class=nav-item><a class=nav-link href=https://kucw.io/about>é—œæ–¼æˆ‘</a></li><li class=nav-item><button id=algolia-search-btn class=algolia-search-btn><i class=ti-search></i></button></li></ul><ul class=navbar-nav><a class=nav-newsletter-link href=/bio target=_blank>é›»å­å ±è¨‚é–±</a></ul></div></nav></div></div></header><div id=algolia-search-pop-overlay class=algolia-search-pop-overlay><div class="popup algolia-search-popup"><div class=algolia-search-header><span class=algolia-search-icon><i class=ti-search></i></span><div id=algolia-search-input-container class=algolia-search-input-container></div><span id=algolia-popup-btn-close class=algolia-popup-btn-close><i class=ti-close></i></span></div><div id=algolia-results class=algolia-results><div id=algolia-hits class=algolia-hits></div><div id=algolia-pagination class=algolia-pagination></div></div></div></div><div id=login-pop-overlay class=login-pop-overlay><div class="popup login-popup"><div class=login-popup-header><img class="img-fluid logo-with-text-size mx-1" src=https://kucw.io/images/logo-with-text-transparent.png alt><div id=login-popup-btn-close class=login-popup-btn-close><i class=ti-close></i></div></div><div class=login-popup-body><button class=google-login-btn id=google-login-btn>
<svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M19.6 10.2c0-.7.0-1.4-.2-2H10V12h5.4c-.3 1.3-1 2.4-2 3v2.6h3.2c2-1.8 3-4.3 3-7.4z" fill="#4285f4"/><path fill-rule="evenodd" clip-rule="evenodd" d="M10 20c2.7.0 5-.9 6.6-2.4L13.4 15a6 6 0 01-9-3.2H1.1v2.6A10 10 0 0010 20z" fill="#34a853"/><path fill-rule="evenodd" clip-rule="evenodd" d="M4.4 11.9a6 6 0 010-3.8V5.5H1.1a10 10 0 000 9l3.3-2.6z" fill="#fbbc05"/><path fill-rule="evenodd" clip-rule="evenodd" d="M10 4c1.5.0 2.8.5 3.8 1.5l2.9-2.9A10 10 0 001 5.5l3.3 2.6A6 6 0 0110 4z" fill="#ea4335"/></svg>
<span class=google-login-btn-text>ä½¿ç”¨ Google ç™»å…¥</span></button><p class=login-terms>By signing in, you agree to å¤å¤çš„å¾Œç«¯ç­†è¨˜'s terms of service and privacy policy.</p></div></div></div><section class=section-sm><div class="container pl-4 pr-4"><div class=row><div class="col-lg-10 mx-auto"><h1 class=blog-title>SpringBoot - å–®å…ƒæ¸¬è©¦å·¥å…· Mockito</h1><div class=author-details><div><img src=https://kucw.io/images/author-sm.png alt class="author-thumb-blog rounded-circle"></div><div><p>å¤å¤</p><p>2020/02/20</p></div></div><hr class=blog-start-divider><div class="content mb-4"><p>Mockitoå°±æ˜¯ä¸€ç¨® Java mock æ¡†æ¶ï¼Œä»–ä¸»è¦æ˜¯ç”¨ä¾†åš mock æ¸¬è©¦çš„ï¼Œä»–å¯ä»¥æ¨¡æ“¬ä»»ä½• Spring ç®¡ç†çš„ beanã€æ¨¡æ“¬æ–¹æ³•çš„è¿”å›å€¼ã€æ¨¡æ“¬æ‹‹å‡ºç•°å¸¸&mldr;ç­‰ï¼Œåœ¨äº†è§£ Mockito çš„å…·é«”ç”¨æ³•ä¹‹å‰ï¼Œå¾—å…ˆäº†è§£ä»€éº¼æ˜¯ mock æ¸¬è©¦</p><h3 id=1-ä»€éº¼æ˜¯-mock-æ¸¬è©¦ class=markdown-heading-anchor>1. ä»€éº¼æ˜¯ mock æ¸¬è©¦ï¼Ÿ
<a href=#1-%e4%bb%80%e9%ba%bc%e6%98%af-mock-%e6%b8%ac%e8%a9%a6>#</a></h3><p>mock æ¸¬è©¦å°±æ˜¯åœ¨æ¸¬è©¦éç¨‹ä¸­ï¼Œå‰µå»ºä¸€å€‹å‡çš„å°è±¡ï¼Œé¿å…ä½ ç‚ºäº†æ¸¬è©¦ä¸€å€‹æ–¹æ³•ï¼Œå»è¦è‡ªè¡Œæ§‹å»ºæ•´å€‹ bean çš„ dependency chain</p><p>åƒæ˜¯ä»¥ä¸‹é€™å¼µåœ–ï¼Œé¡ A éœ€è¦èª¿ç”¨é¡ B å’Œé¡ Cï¼Œè€Œé¡ B å’Œé¡ C åˆéœ€è¦èª¿ç”¨å…¶ä»–é¡å¦‚ Dã€Eã€F ç­‰ï¼Œå‡è¨­é¡ D æ˜¯ä¸€å€‹å¤–éƒ¨æœå‹™ï¼Œé‚£å°±æœƒå¾ˆé›£æ¸¬ï¼Œå› ç‚ºä½ çš„è¿”å›çµæœæœƒç›´æ¥çš„å—å¤–éƒ¨æœå‹™å½±éŸ¿ï¼Œå°è‡´ä½ çš„å–®å…ƒæ¸¬è©¦å¯èƒ½ä»Šå¤©æœƒéã€ä½†æ˜å¤©å°±éä¸äº†äº†</p><p><img src=/images/blog/unittest_mock1.png alt loading=lazy data-zoomable width=528 height=405></p><p>è€Œç•¶æˆ‘å€‘å¼•å…¥ mock æ¸¬è©¦æ™‚ï¼Œå°±å¯ä»¥å‰µå»ºä¸€å€‹å‡çš„å°è±¡ï¼Œæ›¿æ›æ‰çœŸå¯¦çš„ bean B å’Œ Cï¼Œé€™æ¨£åœ¨èª¿ç”¨Bã€Cçš„æ–¹æ³•æ™‚ï¼Œå¯¦éš›ä¸Šå°±æœƒå»èª¿ç”¨é€™å€‹å‡çš„ mock å°è±¡çš„æ–¹æ³•ï¼Œè€Œæˆ‘å€‘å°±å¯ä»¥è‡ªå·±è¨­å®šé€™å€‹ mock å°è±¡çš„åƒæ•¸å’ŒæœŸæœ›çµæœï¼Œè®“æˆ‘å€‘å¯ä»¥å°ˆæ³¨åœ¨æ¸¬è©¦ç•¶å‰çš„é¡ Aï¼Œè€Œä¸æœƒå—åˆ°å…¶ä»–çš„å¤–éƒ¨æœå‹™å½±éŸ¿ï¼Œé€™æ¨£æ¸¬è©¦æ•ˆç‡å°±èƒ½æé«˜å¾ˆå¤š</p><p><img src=/images/blog/unittest_mock2.png alt loading=lazy data-zoomable width=340 height=247></p><h3 id=2-mockito-ç°¡ä»‹ class=markdown-heading-anchor>2. Mockito ç°¡ä»‹
<a href=#2-mockito-%e7%b0%a1%e4%bb%8b>#</a></h3><p>èªªå®Œäº† mock æ¸¬è©¦çš„æ¦‚å¿µï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘é€²å…¥åˆ°ä»Šå¤©çš„ä¸»é¡Œï¼ŒMockito</p><p>Mockito æ˜¯ä¸€ç¨® Java mock æ¡†æ¶ï¼Œä»–ä¸»è¦å°±æ˜¯ç”¨ä¾†åš mock æ¸¬è©¦çš„ï¼Œä»–å¯ä»¥æ¨¡æ“¬ä»»ä½• Spring ç®¡ç†çš„ beanã€æ¨¡æ“¬æ–¹æ³•çš„è¿”å›å€¼ã€æ¨¡æ“¬æ‹‹å‡ºç•°å¸¸&mldr;ç­‰ï¼Œä»–åŒæ™‚ä¹Ÿæœƒè¨˜éŒ„èª¿ç”¨é€™äº›æ¨¡æ“¬æ–¹æ³•çš„åƒæ•¸ã€èª¿ç”¨é †åºï¼Œå¾è€Œå¯ä»¥æ ¡é©—å‡ºé€™å€‹ mock å°è±¡æ˜¯å¦æœ‰è¢«æ­£ç¢ºçš„é †åºèª¿ç”¨ï¼Œä»¥åŠæŒ‰ç…§æœŸæœ›çš„åƒæ•¸è¢«èª¿ç”¨</p><p>åƒæ˜¯ Mockito å¯ä»¥åœ¨å–®å…ƒæ¸¬è©¦ä¸­æ¨¡æ“¬ä¸€å€‹ service è¿”å›çš„æ•¸æ“šï¼Œè€Œä¸æœƒçœŸæ­£å»èª¿ç”¨è©² serviceï¼Œé€™å°±æ˜¯ä¸Šé¢æåˆ°çš„ mock æ¸¬è©¦ç²¾ç¥ï¼Œä¹Ÿå°±æ˜¯é€šéæ¨¡æ“¬ä¸€å€‹å‡çš„ service å°è±¡ï¼Œä¾†å¿«é€Ÿçš„æ¸¬è©¦ç•¶å‰æˆ‘æƒ³è¦æ¸¬è©¦çš„é¡</p><p>ç›®å‰åœ¨ Java ä¸­ä¸»æµçš„ mock æ¸¬è©¦å·¥å…·æœ‰ Mockitoã€JMockã€EasyMock..ç­‰ï¼Œè€Œ SpringBoot ç›®å‰å…§å»ºçš„æ˜¯ Mockito æ¡†æ¶</p><p>é¡Œå¤–è©±èªªä¸€ä¸‹ï¼ŒMockito æ˜¯å‘½åè‡ªä¸€ç¨®èª¿é…’è«å‰æ‰˜ï¼ˆMojitoï¼‰ï¼Œå¤–åœ‹äººä¹Ÿæ„›ç©è«§éŸ³æ¢—ã€‚ã€‚ã€‚</p><h3 id=3-åœ¨-springboot-å–®å…ƒæ¸¬è©¦ä¸­ä½¿ç”¨-mockito class=markdown-heading-anchor>3. åœ¨ SpringBoot å–®å…ƒæ¸¬è©¦ä¸­ä½¿ç”¨ Mockito
<a href=#3-%e5%9c%a8-springboot-%e5%96%ae%e5%85%83%e6%b8%ac%e8%a9%a6%e4%b8%ad%e4%bd%bf%e7%94%a8-mockito>#</a></h3><p>é¦–å…ˆåœ¨ pom.xml ä¸‹æ–°å¢ spring-boot-starter-test ä¾è³´ï¼Œè©²ä¾è³´å…§å°±æœ‰åŒ…å«äº† JUnitã€Mockito</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#0550ae>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;groupId&gt;</span>org.springframework.boot<span style=color:#0550ae>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;artifactId&gt;</span>spring-boot-starter-test<span style=color:#0550ae>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#0550ae>&lt;scope&gt;</span>test<span style=color:#0550ae>&lt;/scope&gt;</span>
</span></span><span style=display:flex><span><span style=color:#0550ae>&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>å…ˆå¯«å¥½ä¸€å€‹ UserServiceï¼Œä»–è£¡é¢æœ‰å…©å€‹æ–¹æ³• <code>getUserById()</code> å’Œ <code>insertUser()</code>ï¼Œè€Œä»–å€‘æœƒåˆ†åˆ¥å»å†å»èª¿ç”¨ UserDao é€™å€‹ beançš„ <code>getUserById()</code> å’Œ <code>insertUser()</code> æ–¹æ³•</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#0550ae>@Component</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#cf222e>public</span><span style=color:#fff> </span><span style=color:#cf222e>class</span> <span style=color:#1f2328>UserService</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#0550ae>@Autowired</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>private</span><span style=color:#fff> </span>UserDao<span style=color:#fff> </span>userDao<span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>public</span><span style=color:#fff> </span>User<span style=color:#fff> </span><span style=color:#6639ba>getUserById</span><span style=color:#1f2328>(</span>Integer<span style=color:#fff> </span>id<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#cf222e>return</span><span style=color:#fff> </span>userDao<span style=color:#1f2328>.</span><span style=color:#1f2328>getUserById</span><span style=color:#1f2328>(</span>id<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>public</span><span style=color:#fff> </span>Integer<span style=color:#fff> </span><span style=color:#6639ba>insertUser</span><span style=color:#1f2328>(</span>User<span style=color:#fff> </span>user<span style=color:#1f2328>)</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#cf222e>return</span><span style=color:#fff> </span>userDao<span style=color:#1f2328>.</span><span style=color:#1f2328>insertUser</span><span style=color:#1f2328>(</span>user<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><p>User model çš„å®šç¾©å¦‚ä¸‹</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#cf222e>public</span><span style=color:#fff> </span><span style=color:#cf222e>class</span> <span style=color:#1f2328>User</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>private</span><span style=color:#fff> </span>Integer<span style=color:#fff> </span>id<span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>private</span><span style=color:#fff> </span>String<span style=color:#fff> </span>name<span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#57606a>//çœç•¥ getter/setter</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><p>å¦‚æœé€™æ™‚å€™æˆ‘å€‘å…ˆä¸ä½¿ç”¨ Mockito æ¨¡æ“¬ä¸€å€‹å‡çš„ userDao beanï¼Œè€Œæ˜¯çœŸçš„å» call ä¸€å€‹æ­£å¸¸çš„ Spring bean çš„ userDao çš„è©±ï¼Œæ¸¬è©¦é¡å¯«æ³•å¦‚ä¸‹ã€‚å…¶å¯¦å°±æ˜¯å¾ˆæ™®é€šçš„æ³¨å…¥ userService beanï¼Œç„¶å¾Œå»èª¿ç”¨ä»–çš„æ–¹æ³•ï¼Œè€Œä»–æœƒå†å» call userDao å–å¾— DB çš„ dataï¼Œç„¶å¾Œæˆ‘å€‘å†å°è¿”å›çµæœåš assert æª¢æŸ¥</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#0550ae>@RunWith</span><span style=color:#1f2328>(</span>SpringRunner<span style=color:#1f2328>.</span><span style=color:#1f2328>class</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#0550ae>@SpringBootTest</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#cf222e>public</span><span style=color:#fff> </span><span style=color:#cf222e>class</span> <span style=color:#1f2328>UserServiceTest</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#57606a>//å…ˆæ™®é€šçš„æ³¨å…¥ä¸€å€‹userService bean</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#0550ae>@Autowired</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>private</span><span style=color:#fff> </span>UserService<span style=color:#fff> </span>userService<span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#0550ae>@Test</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>public</span><span style=color:#fff> </span><span style=color:#cf222e>void</span><span style=color:#fff> </span><span style=color:#6639ba>getUserById</span><span style=color:#1f2328>()</span><span style=color:#fff> </span><span style=color:#cf222e>throws</span><span style=color:#fff> </span>Exception<span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#57606a>//æ™®é€šçš„ä½¿ç”¨userServiceï¼Œä»–è£¡é¢æœƒå†å»call userDaoå–å¾—DBçš„data</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>User<span style=color:#fff> </span>user<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>userService<span style=color:#1f2328>.</span><span style=color:#1f2328>getUserById</span><span style=color:#1f2328>(</span>1<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#57606a>//æª¢æŸ¥çµæœ</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>Assert<span style=color:#1f2328>.</span><span style=color:#1f2328>assertNotNull</span><span style=color:#1f2328>(</span>user<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>Assert<span style=color:#1f2328>.</span><span style=color:#1f2328>assertEquals</span><span style=color:#1f2328>(</span>user<span style=color:#1f2328>.</span><span style=color:#1f2328>getId</span><span style=color:#1f2328>(),</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>Integer<span style=color:#1f2328>(</span>1<span style=color:#1f2328>));</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>Assert<span style=color:#1f2328>.</span><span style=color:#1f2328>assertEquals</span><span style=color:#1f2328>(</span>user<span style=color:#1f2328>.</span><span style=color:#1f2328>getName</span><span style=color:#1f2328>(),</span><span style=color:#fff> </span><span style=color:#0a3069>&#34;John&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><p>ä½†æ˜¯å¦‚æœ userDao é‚„æ²’å¯«å¥½ï¼Œåˆæƒ³å…ˆæ¸¬ userService çš„è©±ï¼Œå°±éœ€è¦ä½¿ç”¨ Mockito å»æ¨¡æ“¬ä¸€å€‹å‡çš„ userDao å‡ºä¾†</p><p>ä½¿ç”¨æ–¹æ³•æ˜¯åœ¨ userDao ä¸ŠåŠ ä¸Šä¸€å€‹ <code>@MockBean</code> æ³¨è§£ï¼Œç•¶ userDao è¢«åŠ ä¸Šé€™å€‹æ³¨è§£ä¹‹å¾Œï¼Œè¡¨ç¤º Mockito æœƒå¹«æˆ‘å€‘å‰µå»ºä¸€å€‹å‡çš„ mock å°è±¡ï¼Œæ›¿æ›æ‰ Spring ä¸­å·²å­˜åœ¨çš„é‚£å€‹çœŸå¯¦çš„ userDao beanï¼Œä¹Ÿå°±æ˜¯èªªï¼Œæ³¨å…¥é€² userService çš„ userDao beanï¼Œå·²ç¶“è¢«æˆ‘å€‘æ›¿æ›æˆå‡çš„ mock å°è±¡äº†ï¼Œæ‰€ä»¥ç•¶æˆ‘å€‘å†æ¬¡èª¿ç”¨ userService çš„æ–¹æ³•æ™‚ï¼Œæœƒå»èª¿ç”¨çš„å¯¦éš›ä¸Šæ˜¯ mock userDao bean çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯çœŸå¯¦çš„ userDao bean</p><p>ç•¶æˆ‘å€‘å‰µå»ºäº†ä¸€å€‹å‡çš„ userDao å¾Œï¼Œæˆ‘å€‘éœ€è¦ç‚ºé€™å€‹ mock userDao è‡ªå®šç¾©æ–¹æ³•çš„è¿”å›å€¼ï¼Œé€™è£¡æœ‰ä¸€å€‹å…¬å¼ç”¨æ³•ï¼Œä¸‹é¢é€™æ®µ code çš„æ„æ€ç‚ºï¼Œç•¶èª¿ç”¨äº†æŸå€‹ mock å°è±¡çš„æ–¹æ³•æ™‚ï¼Œå°±å›å‚³æˆ‘å€‘æƒ³è¦çš„è‡ªå®šç¾©çµæœ</p><pre tabindex=0><code>Mockito.when( å°è±¡.æ–¹æ³•å() ).thenReturn( è‡ªå®šç¾©çµæœ )
</code></pre><p>ä½¿ç”¨ Mockito æ¨¡æ“¬ bean çš„å–®å…ƒæ¸¬è©¦å…·é«”å¯¦ä¾‹å¦‚ä¸‹</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#0550ae>@RunWith</span><span style=color:#1f2328>(</span>SpringRunner<span style=color:#1f2328>.</span><span style=color:#1f2328>class</span><span style=color:#1f2328>)</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#0550ae>@SpringBootTest</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#cf222e>public</span><span style=color:#fff> </span><span style=color:#cf222e>class</span> <span style=color:#1f2328>UserServiceTest</span><span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#0550ae>@Autowired</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>private</span><span style=color:#fff> </span>UserService<span style=color:#fff> </span>userService<span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#0550ae>@MockBean</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>private</span><span style=color:#fff> </span>UserDao<span style=color:#fff> </span>userDao<span style=color:#1f2328>;</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#0550ae>@Test</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#cf222e>public</span><span style=color:#fff> </span><span style=color:#cf222e>void</span><span style=color:#fff> </span><span style=color:#6639ba>getUserById</span><span style=color:#1f2328>()</span><span style=color:#fff> </span><span style=color:#cf222e>throws</span><span style=color:#fff> </span>Exception<span style=color:#fff> </span><span style=color:#1f2328>{</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#57606a>// å®šç¾©ç•¶èª¿ç”¨mock userDaoçš„getUserById()æ–¹æ³•ï¼Œä¸¦ä¸”åƒæ•¸ç‚º3æ™‚ï¼Œå°±è¿”å›idç‚º200ã€nameç‚ºI&#39;m mock3çš„userå°è±¡</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>Mockito<span style=color:#1f2328>.</span><span style=color:#1f2328>when</span><span style=color:#1f2328>(</span>userDao<span style=color:#1f2328>.</span><span style=color:#1f2328>getUserById</span><span style=color:#1f2328>(</span>3<span style=color:#1f2328>)).</span><span style=color:#1f2328>thenReturn</span><span style=color:#1f2328>(</span><span style=color:#cf222e>new</span><span style=color:#fff> </span>User<span style=color:#1f2328>(</span>200<span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#0a3069>&#34;I&#39;m mock 3&#34;</span><span style=color:#1f2328>));</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span><span style=color:#57606a>// è¿”å›çš„æœƒæ˜¯åå­—ç‚ºI&#39;m mock 3çš„userå°è±¡</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>User<span style=color:#fff> </span>user<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>userService<span style=color:#1f2328>.</span><span style=color:#1f2328>getUserById</span><span style=color:#1f2328>(</span>3<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>Assert<span style=color:#1f2328>.</span><span style=color:#1f2328>assertNotNull</span><span style=color:#1f2328>(</span>user<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>Assert<span style=color:#1f2328>.</span><span style=color:#1f2328>assertEquals</span><span style=color:#1f2328>(</span>user<span style=color:#1f2328>.</span><span style=color:#1f2328>getId</span><span style=color:#1f2328>(),</span><span style=color:#fff> </span><span style=color:#cf222e>new</span><span style=color:#fff> </span>Integer<span style=color:#1f2328>(</span>200<span style=color:#1f2328>));</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>        </span>Assert<span style=color:#1f2328>.</span><span style=color:#1f2328>assertEquals</span><span style=color:#1f2328>(</span>user<span style=color:#1f2328>.</span><span style=color:#1f2328>getName</span><span style=color:#1f2328>(),</span><span style=color:#fff> </span><span style=color:#0a3069>&#34;I&#39;m mock 3&#34;</span><span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff>    </span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span><span style=color:#1f2328>}</span><span style=color:#fff>
</span></span></span></code></pre></div><p>Mockito é™¤äº†æœ€åŸºæœ¬çš„ <code>Mockito.when( å°è±¡.æ–¹æ³•å() ).thenReturn( è‡ªå®šç¾©çµæœ )</code>ï¼Œé‚„æä¾›äº†å…¶ä»–ç”¨æ³•è®“æˆ‘å€‘ä½¿ç”¨</p><h4 id=thenreturn-ç³»åˆ—æ–¹æ³• class=markdown-heading-anchor>thenReturn ç³»åˆ—æ–¹æ³•
<a href=#thenreturn-%e7%b3%bb%e5%88%97%e6%96%b9%e6%b3%95>#</a></h4><p>ç•¶ä½¿ç”¨ä»»ä½•æ•´æ•¸å€¼èª¿ç”¨ userService çš„ getUserById() æ–¹æ³•æ™‚ï¼Œå°±å›å‚³ä¸€å€‹åå­—ç‚º I&rsquo;m mock3 çš„ user å°è±¡</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Mockito<span style=color:#1f2328>.</span><span style=color:#1f2328>when</span><span style=color:#1f2328>(</span>userService<span style=color:#1f2328>.</span><span style=color:#1f2328>getUserById</span><span style=color:#1f2328>(</span>Mockito<span style=color:#1f2328>.</span><span style=color:#1f2328>anyInt</span><span style=color:#1f2328>())).</span><span style=color:#1f2328>thenReturn</span><span style=color:#1f2328>(</span><span style=color:#cf222e>new</span><span style=color:#fff> </span>User<span style=color:#1f2328>(</span>3<span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#0a3069>&#34;I&#39;m mock&#34;</span><span style=color:#1f2328>));</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span>User<span style=color:#fff> </span>user1<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>userService<span style=color:#1f2328>.</span><span style=color:#1f2328>getUserById</span><span style=color:#1f2328>(</span>3<span style=color:#1f2328>);</span><span style=color:#fff> </span><span style=color:#57606a>// å›å‚³çš„userçš„åå­—ç‚ºI&#39;m mock</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span>User<span style=color:#fff> </span>user2<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>userService<span style=color:#1f2328>.</span><span style=color:#1f2328>getUserById</span><span style=color:#1f2328>(</span>200<span style=color:#1f2328>);</span><span style=color:#fff> </span><span style=color:#57606a>// å›å‚³çš„userçš„åå­—ä¹Ÿç‚ºI&#39;m mock</span><span style=color:#fff>
</span></span></span></code></pre></div><p>é™åˆ¶åªæœ‰ç•¶åƒæ•¸çš„æ•¸å­—æ˜¯ 3 æ™‚ï¼Œæ‰æœƒå›å‚³åå­—ç‚º I&rsquo;m mock 3 çš„ user å°è±¡</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Mockito<span style=color:#1f2328>.</span><span style=color:#1f2328>when</span><span style=color:#1f2328>(</span>userService<span style=color:#1f2328>.</span><span style=color:#1f2328>getUserById</span><span style=color:#1f2328>(</span>3<span style=color:#1f2328>)).</span><span style=color:#1f2328>thenReturn</span><span style=color:#1f2328>(</span><span style=color:#cf222e>new</span><span style=color:#fff> </span>User<span style=color:#1f2328>(</span>3<span style=color:#1f2328>,</span><span style=color:#fff> </span><span style=color:#0a3069>&#34;I&#39;m mock&#34;</span><span style=color:#1f2328>));</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span>User<span style=color:#fff> </span>user1<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>userService<span style=color:#1f2328>.</span><span style=color:#1f2328>getUserById</span><span style=color:#1f2328>(</span>3<span style=color:#1f2328>);</span><span style=color:#fff> </span><span style=color:#57606a>// å›å‚³çš„userçš„åå­—ç‚ºI&#39;m mock</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span>User<span style=color:#fff> </span>user2<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>userService<span style=color:#1f2328>.</span><span style=color:#1f2328>getUserById</span><span style=color:#1f2328>(</span>200<span style=color:#1f2328>);</span><span style=color:#fff> </span><span style=color:#57606a>// å›å‚³çš„userç‚ºnull</span><span style=color:#fff>
</span></span></span></code></pre></div><p>ç•¶èª¿ç”¨ userService çš„ insertUser() æ–¹æ³•æ™‚ï¼Œä¸ç®¡å‚³é€²ä¾†çš„ user æ˜¯ä»€éº¼ï¼Œéƒ½å›å‚³ 100</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Mockito<span style=color:#1f2328>.</span><span style=color:#1f2328>when</span><span style=color:#1f2328>(</span>userService<span style=color:#1f2328>.</span><span style=color:#1f2328>insertUser</span><span style=color:#1f2328>(</span>Mockito<span style=color:#1f2328>.</span><span style=color:#1f2328>any</span><span style=color:#1f2328>(</span>User<span style=color:#1f2328>.</span><span style=color:#1f2328>class</span><span style=color:#1f2328>))).</span><span style=color:#1f2328>thenReturn</span><span style=color:#1f2328>(</span>100<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span>Integer<span style=color:#fff> </span>i<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>userService<span style=color:#1f2328>.</span><span style=color:#1f2328>insertUser</span><span style=color:#1f2328>(</span><span style=color:#cf222e>new</span><span style=color:#fff> </span>User<span style=color:#1f2328>());</span><span style=color:#fff> </span><span style=color:#57606a>//æœƒè¿”å›100</span><span style=color:#fff>
</span></span></span></code></pre></div><h4 id=thenthrow-ç³»åˆ—æ–¹æ³• class=markdown-heading-anchor>thenThrow ç³»åˆ—æ–¹æ³•
<a href=#thenthrow-%e7%b3%bb%e5%88%97%e6%96%b9%e6%b3%95>#</a></h4><p>ç•¶èª¿ç”¨ userService çš„ getUserById() æ™‚çš„åƒæ•¸æ˜¯ 9 æ™‚ï¼Œæ‹‹å‡ºä¸€å€‹ RuntimeException</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Mockito<span style=color:#1f2328>.</span><span style=color:#1f2328>when</span><span style=color:#1f2328>(</span>userService<span style=color:#1f2328>.</span><span style=color:#1f2328>getUserById</span><span style=color:#1f2328>(</span>9<span style=color:#1f2328>)).</span><span style=color:#1f2328>thenThrow</span><span style=color:#1f2328>(</span><span style=color:#cf222e>new</span><span style=color:#fff> </span>RuntimeException<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;mock throw exception&#34;</span><span style=color:#1f2328>));</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span>User<span style=color:#fff> </span>user<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>userService<span style=color:#1f2328>.</span><span style=color:#1f2328>getUserById</span><span style=color:#1f2328>(</span>9<span style=color:#1f2328>);</span><span style=color:#fff> </span><span style=color:#57606a>//æœƒæ‹‹å‡ºä¸€å€‹RuntimeException</span><span style=color:#fff>
</span></span></span></code></pre></div><p>å¦‚æœæ–¹æ³•æ²’æœ‰è¿”å›å€¼çš„è©±ï¼ˆå³æ˜¯æ–¹æ³•å®šç¾©ç‚º<code>public void myMethod() {...}</code>ï¼‰ï¼Œè¦æ”¹ç”¨ doThrow() æ‹‹å‡º Exception</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Mockito<span style=color:#1f2328>.</span><span style=color:#1f2328>doThrow</span><span style=color:#1f2328>(</span><span style=color:#cf222e>new</span><span style=color:#fff> </span>RuntimeException<span style=color:#1f2328>(</span><span style=color:#0a3069>&#34;mock throw exception&#34;</span><span style=color:#1f2328>)).</span><span style=color:#1f2328>when</span><span style=color:#1f2328>(</span>userService<span style=color:#1f2328>).</span><span style=color:#1f2328>print</span><span style=color:#1f2328>();</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span>userService<span style=color:#1f2328>.</span><span style=color:#1f2328>print</span><span style=color:#1f2328>();</span><span style=color:#fff> </span><span style=color:#57606a>//æœƒæ‹‹å‡ºä¸€å€‹RuntimeException</span><span style=color:#fff>
</span></span></span></code></pre></div><h4 id=verify-ç³»åˆ—æ–¹æ³• class=markdown-heading-anchor>verify ç³»åˆ—æ–¹æ³•
<a href=#verify-%e7%b3%bb%e5%88%97%e6%96%b9%e6%b3%95>#</a></h4><p>æª¢æŸ¥èª¿ç”¨ userService çš„ getUserById()ã€ä¸”åƒæ•¸ç‚º3çš„æ¬¡æ•¸æ˜¯å¦ç‚º1æ¬¡</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Mockito<span style=color:#1f2328>.</span><span style=color:#1f2328>verify</span><span style=color:#1f2328>(</span>userService<span style=color:#1f2328>,</span><span style=color:#fff> </span>Mockito<span style=color:#1f2328>.</span><span style=color:#1f2328>times</span><span style=color:#1f2328>(</span>1<span style=color:#1f2328>)).</span><span style=color:#1f2328>getUserById</span><span style=color:#1f2328>(</span>Mockito<span style=color:#1f2328>.</span><span style=color:#1f2328>eq</span><span style=color:#1f2328>(</span>3<span style=color:#1f2328>));</span><span style=color:#fff>
</span></span></span></code></pre></div><p>é©—è­‰èª¿ç”¨é †åºï¼Œé©—è­‰ userService æ˜¯å¦å…ˆèª¿ç”¨ getUserById() å…©æ¬¡ï¼Œä¸¦ä¸”ç¬¬ä¸€æ¬¡çš„åƒæ•¸æ˜¯ 3ã€ç¬¬äºŒæ¬¡çš„åƒæ•¸æ˜¯ 5ï¼Œç„¶å¾Œæ‰èª¿ç”¨insertUser() æ–¹æ³•</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>InOrder<span style=color:#fff> </span>inOrder<span style=color:#fff> </span><span style=color:#0550ae>=</span><span style=color:#fff> </span>Mockito<span style=color:#1f2328>.</span><span style=color:#1f2328>inOrder</span><span style=color:#1f2328>(</span>userService<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span>inOrder<span style=color:#1f2328>.</span><span style=color:#1f2328>verify</span><span style=color:#1f2328>(</span>userService<span style=color:#1f2328>).</span><span style=color:#1f2328>getUserById</span><span style=color:#1f2328>(</span>3<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span>inOrder<span style=color:#1f2328>.</span><span style=color:#1f2328>verify</span><span style=color:#1f2328>(</span>userService<span style=color:#1f2328>).</span><span style=color:#1f2328>getUserById</span><span style=color:#1f2328>(</span>5<span style=color:#1f2328>);</span><span style=color:#fff>
</span></span></span><span style=display:flex><span><span style=color:#fff></span>inOrder<span style=color:#1f2328>.</span><span style=color:#1f2328>verify</span><span style=color:#1f2328>(</span>userService<span style=color:#1f2328>).</span><span style=color:#1f2328>insertUser</span><span style=color:#1f2328>(</span>Mockito<span style=color:#1f2328>.</span><span style=color:#1f2328>any</span><span style=color:#1f2328>(</span>User<span style=color:#1f2328>.</span><span style=color:#1f2328>class</span><span style=color:#1f2328>));</span><span style=color:#fff>
</span></span></span></code></pre></div><h3 id=4-mockito-çš„é™åˆ¶ class=markdown-heading-anchor>4. Mockito çš„é™åˆ¶
<a href=#4-mockito-%e7%9a%84%e9%99%90%e5%88%b6>#</a></h3><p>ä¸Šè¿°å°±æ˜¯ Mockito çš„ mock å°è±¡ä½¿ç”¨æ–¹æ³•ï¼Œä¸éç•¶ä½¿ç”¨ Mockito åœ¨ mock å°è±¡æ™‚ï¼Œæœ‰ä¸€äº›é™åˆ¶éœ€è¦éµå®ˆ</p><ul><li>ä¸èƒ½ mock éœæ…‹æ–¹æ³•</li><li>ä¸èƒ½ mock private æ–¹æ³•</li><li>ä¸èƒ½ mock final class</li></ul><p>å› æ­¤åœ¨å¯« code æ™‚ï¼Œéœ€è¦åšè‰¯å¥½çš„åŠŸèƒ½æ‹†åˆ†ï¼Œæ‰èƒ½å¤ ä½¿ç”¨ Mockito çš„ mock æŠ€è¡“ï¼Œå¹«åŠ©æˆ‘å€‘é™ä½æ¸¬è©¦æ™‚ bean çš„ dependency</p><h3 id=5-ç¸½çµ class=markdown-heading-anchor>5. ç¸½çµ
<a href=#5-%e7%b8%bd%e7%b5%90>#</a></h3><p>Mockito æ˜¯ä¸€å€‹éå¸¸å¼·å¤§çš„æ¡†æ¶ï¼Œå¯ä»¥åœ¨åŸ·è¡Œå–®å…ƒæ¸¬è©¦æ™‚å¹«åŠ©æˆ‘å€‘æ¨¡æ“¬ä¸€å€‹ beanï¼Œæé«˜å–®å…ƒæ¸¬è©¦çš„ç©©å®šæ€§ï¼Œä¸¦ä¸”å¤§å®¶å¯ä»¥å˜—è©¦åœ¨å¯« code æ™‚ï¼Œå¾ mock æ¸¬è©¦çš„è§’åº¦ä¾†å¯«ï¼Œæ›´èƒ½å¤ å¯«å‡ºåŠŸèƒ½åˆ‡åˆ†è‰¯å¥½çš„ code modules</p><p>åƒæ˜¯å¦‚æœæœ‰æŠŠå°ˆé–€å’Œå¤–éƒ¨ service æºé€šçš„ code æŠ½å‡ºä¾†æˆä¸€å€‹ beanï¼Œåœ¨é€²è¡Œå–®å…ƒæ¸¬è©¦æ™‚ï¼Œåªè¦é€é Mockito æ›´æ›æ‰é‚£å€‹ bean å°±è¡Œäº†</p><blockquote><p>å¦‚æœæƒ³äº†è§£æ›´å¤š Spring Boot çš„ç”¨æ³•ï¼Œä¹Ÿæ­¡è¿åƒè€ƒæˆ‘é–‹è¨­çš„ç·šä¸Šèª²ç¨‹ <a href=https://hahow.in/cr/springboot target=_blank rel=noopener>Java å·¥ç¨‹å¸«å¿…å‚™ï¼Spring Boot é›¶åŸºç¤å…¥é–€</a> <strong>ï¼ˆè¼¸å…¥æŠ˜æ‰£ç¢¼ã€ŒHH202601KUã€å³å¯äº« 85 æŠ˜å„ªæƒ ï¼‰</strong>ã€‚</p></blockquote></div><div class=blog-newsletter><h4>å…è²»è¨‚é–±ã€Šå¤å¤çš„å¾Œç«¯ç­†è¨˜ã€‹é›»å­å ±ï¼ˆé•·æœŸä¼‘åˆŠä¸­ï¼‰</h4><div><p>æ¯é€±äºŒå­¸ç¿’å¾Œç«¯æŠ€è¡“ï¼Œå’Œ 3600 äººä¸€èµ·è®Šå¼·ğŸ’ª</p><div id=blog-newsletter class=newsletter><div class="row justify-content-center"><div class=col-md-8><div class=success>å·²ç™¼é€ Email é©—è­‰ä¿¡ï¼è«‹å‰å¾€ä¿¡ç®±é©—è­‰ä½ çš„è¨‚é–±</div><div class=error>è¨‚é–±å¤±æ•—ï¼Œè«‹æª¢æŸ¥ Email æ˜¯å¦è¼¸å…¥éŒ¯èª¤ï¼Œæˆ–æ˜¯è¯ç¹« service@kucw.io å–å¾—å”åŠ©</div><div class=maintenance>é›»å­å ±ä¼ºæœå™¨æ­£åœ¨ç¶­è­·ä¸­ï¼Œè«‹ç¨å¾Œå†è©¦</div></div></div><form action=# method=POST class="row justify-content-center"><div class="input-group col-md-8"><input type=email required name=email class=form-control placeholder="è¼¸å…¥ä½ çš„ Email"><div class=input-group-append><button type=submit class="input-group-text btn btn-primary">
å…è²»è¨‚é–±</button></div></div></form></div></div></div><hr class=blog-end-divider><script src=https://utteranc.es/client.js label=comment repo=kucw/kucw.github.io issue-term=title theme=github-light crossorigin=anonymous async></script></div></div></div></section><footer><div class=container><div class="row justify-content-center pb-4"><div class="col-12 text-center mb-5"><a href=https://kucw.io/><img class="img-fluid logo-thumb-md rounded-circle mx-1" src=https://kucw.io/images/logo.png alt=å¤å¤çš„å¾Œç«¯ç­†è¨˜></a></div></div><div class="row pb-1"><div class="col-lg-8 text-center pb-5"><h4>å…è²»è¨‚é–±é›»å­å ±ï¼Œæ¯é€±äºŒå­¸ç¿’å¾Œç«¯æŠ€è¡“ğŸš€<br>ï¼ˆé•·æœŸä¼‘åˆŠä¸­ï¼‰</h4><div id=footer-newsletter class=newsletter><div class="row justify-content-center"><div class=col-md-8><div class=success>å·²ç™¼é€ Email é©—è­‰ä¿¡ï¼è«‹å‰å¾€ä¿¡ç®±é©—è­‰ä½ çš„è¨‚é–±</div><div class=error>è¨‚é–±å¤±æ•—ï¼Œè«‹æª¢æŸ¥ Email æ˜¯å¦è¼¸å…¥éŒ¯èª¤ï¼Œæˆ–æ˜¯è¯ç¹« service@kucw.io å–å¾—å”åŠ©</div><div class=maintenance>é›»å­å ±ä¼ºæœå™¨æ­£åœ¨ç¶­è­·ä¸­ï¼Œè«‹ç¨å¾Œå†è©¦</div></div></div><form action=# method=POST class="row justify-content-center"><div class="input-group col-md-8"><input type=email required name=email class=form-control placeholder="è¼¸å…¥ä½ çš„ Email"><div class=input-group-append><button type=submit class="input-group-text btn btn-primary">
å…è²»è¨‚é–±</button></div></div></form></div></div><div class="col-lg-4 pb-3 footer-contact-me"><h5 class=mb-4>è¿½è¹¤å¤å¤</h5><ul class="list-inline footer-social-links"><li class=list-inline-item><a href=https://github.com/kucw target=_blank rel=noopener><i class=ti-github></i></a></li><li class=list-inline-item><a href=https://www.facebook.com/kucw.io target=_blank rel=noopener><i class=ti-facebook></i></a></li><li class=list-inline-item><a href=https://www.instagram.com/kucw.io/ target=_blank rel=noopener><i class=ti-instagram></i></a></li></ul><p>è¯çµ¡ä¿¡ç®±: service@kucw.io</p></div></div><div class="border-top py-4 text-center">Â© 2020-2025 å¤å¤çš„å¾Œç«¯ç­†è¨˜ | All Rights Reserved.</div></div></div></footer><script>var indexURL="https://kucw.io/index.json"</script><script src=https://kucw.io/plugins/jQuery/jquery.min.js></script><script src=https://kucw.io/plugins/bootstrap/bootstrap.min.js></script><script src=https://kucw.io/plugins/mailbluster/mailbluster.js></script><script src=https://kucw.io/plugins/confetti/confetti.browser.min.js></script><script src=https://kucw.io/plugins/confetti/welcomeConfetti.js></script><script src=https://kucw.io/plugins/medium-zoom/medium-zoom.min.js></script><script src=https://kucw.io/plugins/algolia-search/algoliasearch.js></script><script src=https://kucw.io/plugins/algolia-search/algoliasearch-lite.umd.js></script><script src=https://kucw.io/plugins/algolia-search/instantsearch.production.min.js></script><script src=https://kucw.io/plugins/clipboard/clipboard.min.js></script><script src=https://kucw.io/plugins/clipboard/code-clipboard.js></script><script src=https://kucw.io/plugins/login/login.js></script><script src=https://kucw.io/js/script.min.aa7e377695025ea8426da51bc7ddbc5d24fa31916deb7d8d442296c493598de4.js></script></body></html>